<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Make MCQ â€” AI Study</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="../styles.css">
</head>
<body>
<aside class="sidebar" id="sidebar">
  <div class="brand">AI Study</div>
  <a href="../index.html">Home</a>
  <a href="summarize.html">Summarize PDF</a>
  <a href="make-notes.html">Make Notes</a>
  <a href="mcq.html" class="active">Make MCQ</a>
  <a href="explain.html">Explain</a>
  <a href="qna.html">QnA</a>
  <a href="notes.html">Notes History</a>
  <div class="spacer"></div>
  <a href="profile.html">Update Profile</a>
  <a href="delete-account.html">Delete Account</a>
</aside>

<main class="content-with-sidebar">
  <div class="page-wrapper container">
    <h1 class="h-gradient">MCQ Generator</h1>
    <p class="center mt-18">Generate practice MCQs from a topic or text.</p>

    <div class="card mt-18">
      <textarea id="mcq-text" rows="6" placeholder="Enter topic or paste text..." style="width:100%;padding:12px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff"></textarea>
      <div style="display:flex;gap:12px;margin-top:12px;align-items:center">
        <input id="mcq-count" type="number" min="1" max="30" value="5" style="width:80px;padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">
        <button id="mcq-submit" class="btn-primary">Generate MCQs</button>
        <span id="mcq-loader" class="loader hidden"></span>
      </div>
    </div>

    <div id="mcq-result" class="result-card"></div>
  </div>
</main>

<script src="../app.js"></script>
<script>
document.getElementById('mcq-submit').addEventListener('click', async ()=>{
  const text = document.getElementById('mcq-text').value.trim();
  const count = parseInt(document.getElementById('mcq-count').value||'5',10);
  const out = document.getElementById('mcq-result'), loader = document.getElementById('mcq-loader');
  if (!text) { out.innerText='Enter topic/text'; return; }
  loader.classList.remove('hidden'); out.innerHTML='';
  try{
    const token = localStorage.getItem('ai_study_token');
    const res = await fetch((window.API_BASE||'') + '/make-mcq', { method:'POST', headers:{ 'Content-Type':'application/json', ...(token?{Authorization:'Bearer '+token}:{}) }, body: JSON.stringify({ text, count })});
    const json = await res.json();
    let html = '<h3>MCQs</h3>';
    if (Array.isArray(json)) {
      html += '<ol>';
      json.forEach(q=> {
        html += `<li><strong>${q.question||q.title||''}</strong><br>`;
        if (q.options) html += q.options.map((o,i)=>`<div>${String.fromCharCode(65+i)}) ${o}</div>`).join('');
        html += '</li>';
      });
      html += '</ol>';
    } else {
      html += '<pre>' + JSON.stringify(json, null,2) + '</pre>';
    }
    out.innerHTML = html;
  }catch(err){ out.innerText = 'Error: '+(err.message||err) }
  finally{ loader.classList.add('hidden') }
});
</script>
</body>
</html>
