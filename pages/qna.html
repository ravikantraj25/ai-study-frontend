<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>QnA — AI Study</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="../styles.css">
</head>
<body>
<aside class="sidebar" id="sidebar">
  <div class="brand">AI Study</div>
  <a href="../index.html">Home</a>
  <a href="summarize.html">Summarize PDF</a>
  <a href="make-notes.html">Make Notes</a>
  <a href="mcq.html">Make MCQ</a>
  <a href="explain.html">Explain</a>
  <a href="qna.html" class="active">QnA</a>
  <a href="notes.html">Notes History</a>
  <div class="spacer"></div>
  <a href="profile.html">Update Profile</a>
  <a href="delete-account.html">Delete Account</a>
</aside>

<main class="content-with-sidebar">
  <div class="page-wrapper container">
    <h1 class="h-gradient">Ask Questions</h1>
    <p class="center mt-18">Ask specific questions — get concise answers with references if available.</p>
    <div class="card mt-18">
      <input id="qna-question" placeholder="Ask anything..." style="width:100%;padding:12px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">
      <div style="margin-top:12px;display:flex;gap:12px;">
        <button id="qna-submit" class="btn-primary">Ask</button>
        <span id="qna-loader" class="loader hidden"></span>
      </div>
    </div>
    <div id="qna-result" class="result-card"></div>
  </div>
</main>

<script src="../app.js"></script>
<script>
document.getElementById('qna-submit').addEventListener('click', async ()=>{
  const q = document.getElementById('qna-question').value.trim(), out = document.getElementById('qna-result'), loader = document.getElementById('qna-loader');
  if (!q) { out.innerText='Enter a question'; return; }
  loader.classList.remove('hidden'); out.innerHTML='';
  try{
    const token = localStorage.getItem('ai_study_token');
    const res = await fetch((window.API_BASE||'') + '/qna', { method:'POST', headers:{ 'Content-Type':'application/json', ...(token?{Authorization:'Bearer '+token}:{}) }, body: JSON.stringify({ question: q })});
    const json = await res.json();
    const ans = json.answer || json.text || JSON.stringify(json,null,2);
    out.innerHTML = '<h3>Answer</h3><p>' + String(ans).replace(/\n/g,'<br>') + '</p>';
  }catch(err){ out.innerText = 'Error: ' + (err.message||err) }
  finally{ loader.classList.add('hidden') }
});
</script>
</body>
</html>
